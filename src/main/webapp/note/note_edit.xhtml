<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="jakarta.faces.html"
                xmlns:ui="jakarta.faces.facelets"
                xmlns:f="jakarta.faces.core"
                template="/WEB-INF/template/main.xhtml">

    <f:metadata>
        <f:viewParam name="noteId" value="#{noteEditView.noteId}" />
        <f:viewParam name="figureId" value="#{noteEditView.figureId}" />

        <f:viewAction action="#{noteEditView.loadData}" />
    </f:metadata>

    <ui:define name="title">#{noteEditView.noteId == null ? 'Nowa notatka' : 'Edycja notatki'}</ui:define>

    <ui:define name="content">
        <h2>#{noteEditView.noteId == null ? 'Tworzenie nowej notatki' : 'Edycja notatki'}</h2>
        <hr/>

        <h:form id="noteForm" styleClass="col-md-6">

            <div class="form-outline mb-4">
                <h:inputText id="title" value="#{noteEditView.note.title}" styleClass="form-control"
                             required="true"
                             requiredMessage="Pole 'Tytuł' jest obowiązkowe." />
                <h:outputLabel for="title" styleClass="form-label">Tytuł</h:outputLabel>
                <h:message for="title" styleClass="text-danger" />
            </div>

            <div class="form-outline mb-4">
                <h:inputTextarea id="content" value="#{noteEditView.note.content}" styleClass="form-control" rows="5"
                                 required="true"
                                 requiredMessage="Treść notatki nie może być pusta." />
                <h:outputLabel for="content" styleClass="form-label">Treść</h:outputLabel>
                <h:message for="content" styleClass="text-danger" />
            </div>

            <div class="mb-4">
                <label for="mode" class="form-label">Tryb</label>
                <h:selectOneMenu id="mode" value="#{noteEditView.note.mode}" styleClass="form-select">
                    <f:selectItems value="#{noteEditView.modes}" var="m"
                                   itemLabel="#{m.name()}" itemValue="#{m}" />
                </h:selectOneMenu>
            </div>

            <div class="mb-4">
                <label for="figureSelect" class="form-label">Postać Historyczna</label>
                <h:selectOneMenu id="figureSelect"
                                 value="#{noteEditView.note.historicalFigureId}"
                                 styleClass="form-select" required="true">
                    <f:facet name="prompt">-- Wybierz postać --</f:facet>
                    <f:selectItems value="#{noteEditView.availableFigures}"
                                   var="fig"
                                   itemLabel="#{fig.name}"
                                   itemValue="#{fig.id}" />
                </h:selectOneMenu>
            </div>

            <h:commandButton value="Zapisz" action="#{noteEditView.save}" styleClass="btn btn-primary" />

            <h:link outcome="/note/notes" value="Anuluj" styleClass="btn btn-link" />

        </h:form>
    </ui:define>
</ui:composition>