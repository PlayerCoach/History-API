<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="jakarta.faces.html"
                xmlns:ui="jakarta.faces.facelets"
                xmlns:f="jakarta.faces.core"
                template="/WEB-INF/template/main.xhtml">

    <f:metadata>
        <f:viewParam name="noteId" value="#{noteDetailView.noteId}" required="true" />
    </f:metadata>

    <ui:define name="title">
        #{msg['notes.detail.title']} #{noteDetailView.note.title}
    </ui:define>

    <ui:define name="content">
        <h:panelGroup rendered="#{noteDetailView.note == null}">
            <h2>#{msg['notes.notFound']}</h2>
        </h:panelGroup>

        <h:panelGroup rendered="#{noteDetailView.note != null}">
            <h2>#{noteDetailView.note.title}</h2>
            <hr/>

            <dl class="row">
                <dt class="col-sm-3">#{msg['notes.detail.id']}</dt>
                <dd class="col-sm-9">#{noteDetailView.note.id}</dd>

                <dt class="col-sm-3">#{msg['notes.detail.figure']}</dt>
                <dd class="col-sm-9">#{noteDetailView.figure.name}</dd>

                <dt class="col-sm-3">#{msg['notes.detail.mode']}</dt>
                <dd class="col-sm-9">#{noteDetailView.note.mode}</dd>

                <dt class="col-sm-3">#{msg['notes.detail.content']}</dt>
                <dd class="col-sm-9"><pre style="white-space: pre-wrap;">#{noteDetailView.note.content}</pre></dd>
            </dl>

            <hr/>
            <div class="btn-group" role="group">
                <h:link outcome="/historicalfigure/figure"
                        value="#{msg['notes.detail.backToFigure'].replace('{0}', noteDetailView.figure.name)}"
                        styleClass="btn btn-secondary">
                    <f:param name="figureId" value="#{noteDetailView.figure.id}" />
                </h:link>

                <!-- Tylko właściciel lub admin może edytować -->
                <h:link outcome="/note/note_edit"
                        value="#{msg['notes.action.edit']}"
                        styleClass="btn btn-primary"
                        rendered="#{authView.admin or (noteDetailView.note.createdBy != null and noteDetailView.note.createdBy.login eq authView.username)}">
                    <f:param name="noteId" value="#{noteDetailView.note.id}" />
                </h:link>
            </div>

        </h:panelGroup>
    </ui:define>
</ui:composition>

